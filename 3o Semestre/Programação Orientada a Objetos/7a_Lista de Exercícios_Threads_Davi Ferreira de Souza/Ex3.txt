O método invokeAndWait(...) enfileira o bloco de atualização da GUI para execução na Event Dispatch Thread (EDT) e bloqueia o thread atual até que aquele bloco seja processado. Assim você garante (1) que a atualização ocorra no único thread seguro para mexer em componentes Swing e (2) que seu loop de progresso só avance depois que a barra tiver sido efetivamente repintada, evitando artefatos visuais ou condições de corrida.
